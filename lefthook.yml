pre-commit:
  commands:
    fmt:
      run: goimports -w .
      glob: "*.go"
      stage_fixed: true
    vet:
      run: go vet ./...
      glob: "*.go"
    test:
      run: go test ./...
      glob: "*.go"
    mod-tidy:
      run: go mod tidy
      glob: "*.go"
      stage_fixed: true


pre-push:
  commands:
    test:
      run: go test ./...
      glob: "*.go"
    build:
      run: go build -o wt
      glob: "*.go"
    review:
      run: |
        echo "üîç Reviewing changes before push..."
        git diff main...HEAD | claude -p 'Review this code diff. Focus on: 1) Potential bugs/issues 2) Code quality problems 3) Missing error handling 4) Security concerns. Rate severity: LOW/MEDIUM/HIGH. Be concise but thorough. Output should be in Japanese.'
        echo ""
        read -p "Continue with push? (Y/n): " -n 1 -r
        echo
        if [[ $REPLY =~ ^[Nn]$ ]]; then
          echo "‚ùå Push cancelled"
          exit 1
        fi
        echo "‚úÖ Proceeding with push..."
      interactive: true
